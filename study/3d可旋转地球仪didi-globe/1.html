<html>
<head>
  <title></title>
  <script src="three.js"></script>
<!--  <link href="style.css" rel="stylesheet"/>-->
  <style type="text/css"></style>
  <style type="text/css">
    
  </style>

</head>
<body>

        <div class="mask-five-content" id="container"
             style="color: rgb(255, 255, 255); font: 13px / 20px Arial, sans-serif; cursor: auto;">
        </div>
      
<script>
  var SCREEN_WIDTH = null;
  var SCREEN_HEIGHT = null;
  var scene = null;
  var mesh = null;
  var camera = null;
  var renderer = null;
  var container = document.getElementById('container')
  var me = false
  var mouse = new THREE.Vector2;
  var pos = {
    x: 0,
    y: 0
  };
  var rotation = {
    x: 0,
    y: 0
  };
  var target = {
    x: 2.1 * Math.PI,
    y: Math.PI / 4.5
  };
  var p = {
    x: 0,
    y: 0
  };
  var de = false;

  var type = "";
  var node = "";
  //网页加载完毕后会被调用
  function init() {
      SCREEN_WIDTH = width();
      SCREEN_HEIGHT = width();
    
    //创建一个场景（场景是一个容器，用于保存、跟踪所要渲染的物体和使用的光源）
    scene = new THREE.Scene();

    //创建一个摄像机对象
    camera = new THREE.PerspectiveCamera(30, SCREEN_WIDTH / SCREEN_HEIGHT, 1, 1e4);
    camera.position.x = 30;
    camera.position.y = 30;
    camera.position.z = 30;
    camera.lookAt(new THREE.Vector3(0, 0, 0));

    scene.add(new THREE.AmbientLight('#0f0'));

    //创建一个WebGL渲染器并设置其大小
    renderer = new THREE.WebGLRenderer({
      antialias: true,
      alpha: true
    });
    renderer.setPixelRatio(window.devicePixelRatio);
    //renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
    //renderer.setClearColor(new THREE.Color(0x00000)); //0xc0c0c0
    renderer.setSize(775, 775);
    renderer.shadowMap.enabled = true;

    //将渲染的结果输出到指定页面元素中
    //document.getElementById("WebGL-output").appendChild(renderer.domElement);
    container.appendChild(renderer.domElement);




    drawGlobe()

  }



  var t = new THREE.SphereGeometry(3, 20, 20);
  var multiply = new THREE.MeshBasicMaterial({
    color: '#DF5943'
  });

 

  var PI_HALF = Math.PI / 2;




  function width() {
      if (!container) {
        return;
      }
      return window.innerWidth;
  }
  
  var isStop = false;

 

  function drawGlobe() {
        // 画地球
    const textureLoader = new THREE.TextureLoader()
    const texture = textureLoader.load('./dist/img/world.png');
    const material = new THREE.MeshBasicMaterial({
      map: texture,
      overdraw: .5,
      transparent: true,
      side: THREE.DoubleSide
    });
    var sphereGeometry = new THREE.SphereGeometry(200, 40, 30);
    mesh = new THREE.Mesh(sphereGeometry, material);
    mesh.name = "scene";
    mesh.rotation.y = .7 * Math.PI;
    mesh.receiveShadow = true;
    mesh.castShadow = true;
    scene.add(mesh);
  }


  var step = 0;
  // var a = 138.68;

  var viewX = 0;
  var x = 1e3;
  var j = 1e3;

  function applyForEach(viewX) {
    /** @type {number} */
    x = x - viewX;
    x = x > 1e3 ? 1e3 : x;
    x = x < 350 ? 350 : x;
  }

  var rotation = {
    x: 0,
    y: 0
  };
  var target = {
    x: 2.1 * Math.PI,
    y: Math.PI / 4.5
  };
  var be = 0;
  var we = true;

  function render() {
    applyForEach(viewX);

    if (we) {
      if (be === target.x + target.y) {
        target.x -= .005;
      } else {
        be = target.x + target.y;
      }
      rotation.x += .1 * (target.x - rotation.x);
      rotation.y += .1 * (target.y - rotation.y);
      j = j + .3 * (x - j);
      /** @type {number} */
      camera.position.x = j * Math.sin(rotation.x) * Math.cos(rotation.y);
      /** @type {number} */
      camera.position.y = j * Math.sin(rotation.y);
      /** @type {number} */
      camera.position.z = j * Math.cos(rotation.x) * Math.cos(rotation.y);
    }
    // mesh.material.uniforms.time.value += 0.1;
    camera.lookAt(mesh.position);
    // requestAnimationFrame(render);
    renderer.render(scene, camera);
  }

  function animation() {
    if (!isStop) {
      requestAnimationFrame(animation);
      render();
    }
  }

  //确保init方法在网页加载完毕后被调用
  window.onload = init;
  animation()
</script>
</body>
</html>
