<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin:0;
            padding:0;
            user-select: none;
        }
    </style>
</head>
<body>
    <div style="position:fixed;right:10px;top:10px;">
        帧率:<span id="fps"></span>
    </div>
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <script type="importmap">
        {
            "imports":{
                "three":"./src/three.module.js"
            }
        }
    </script>
    <script type="module">

        import * as THREE from 'three'
        import {OrbitControls} from './src/OrbitControls.js'
        import {GLTFLoader} from './src/GLTFLoader.js'
        import Stats from './src/stats.module.js'
        const stats = new Stats();
        document.body.appendChild(stats.dom)


        console.log(THREE);
        //创建一个3D场景
        const scene = new THREE.Scene()
        //创建一个长方体
        const geometry = new THREE.BoxGeometry(20,20,20)
        //设置材质
        const material = new THREE.MeshLambertMaterial({
            color:0xff11ff,
            transparent:true,
            opacity:0.6
        })




        //const mesh = new THREE.Mesh(geometry,material)
        //mesh.position.set(0,0,0)
        //把网格模型添加到3D场景中
        //scene.add(mesh)
        // for (let i = 0; i < 10; i++) {
        //     for (let j = 0; j < 10; j++) {
        //         //创建一个网格模型对象 把创建的物体和材质绑定到网格模型
        //         const mesh = new THREE.Mesh(geometry,material)
        //         mesh.position.set(i*150,0,j*150)
        //         //把网格模型添加到3D场景中
        //         scene.add(mesh)
        //     }
        // }
        

        //添加一个环境光 
        const ambient = new THREE.AmbientLight('ffffff',.4)
        scene.add(ambient)
        //添加一个平行光
        //const directional = new THREE.DirectionalLight('ffffff',1)
        //scene.add(directional)
        //添加一个半球光
        //const hemisphere = new THREE.HemisphereLight('ffffff',1)
        //scene.add(hemisphere)
        //添加一个点光源
        const point = new THREE.PointLight('ffffff',1)
        point.position.set(100,80,50)
        scene.add(point)
        //点光源辅助观察 显示点光源位置
        //const pointHelper = new THREE.PointLightHelper(point,5)
        //scene.add(pointHelper)

        //添加3D坐标系
        //const axes = new THREE.AxesHelper(300)
        //scene.add(axes)
        //console.log(scene);
        //创建一个透视相机
        let width = window.innerWidth,
            height = window.innerHeight;
        const camera = new THREE.PerspectiveCamera( 30, width / height, 1, 10000 );
        //设置相机的位置
        camera.position.set(100,100,100)
        //设置相机的拍摄方向
        camera.lookAt(0,0,0)

        
        

        //创建一个webgl渲染器
        const renderer = new THREE.WebGLRenderer({
            alpha:true
        })
        //设置渲染的宽高
        renderer.setSize(width,height)
        //执行渲染
        renderer.render(scene,camera)
        //输出到页面
        document.body.appendChild(renderer.domElement)
        var mesh = null;
        //相机轨道控制器
        const controls = new OrbitControls(camera,renderer.domElement)
        //controls.target.set(750,0,750)
        // controls.minDistance = 80;
        // controls.maxDistance = 400;
        // controls.maxPolarAngle = Math.PI / 3;
        //controls.update()

            const loader = new GLTFLoader();
            loader.load( './models/Parrot.glb', function ( gltf ) {
                mesh = gltf.scene
                mesh.position.set(0,0,0)
                scene.add( gltf.scene );
            } );


        // const loader = new GLTFLoader()
        // const dracoLoader = new DRACOLoader();
        // dracoLoader.setDecoderPath( 'models/' );
        // loader.setDRACOLoader( dracoLoader );
        // loader.load('models/Flower.glb',function(gltf){
        //     console.log(gltf);
        //     const model = gltf.scene;
        //     model.position.set( 50, 1, 0 );
        //     scene.add( model );
        // },function(xhr){
        //     console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );
        // },function(err){
        //     console.log( 'An error happened' );
        // })



        const clock = new THREE.Clock()
        function renderFrame(){
            requestAnimationFrame(renderFrame)
            if(mesh){
                mesh.rotateY(0.01)
            }
            stats.update()
            renderer.render(scene,camera)
        }
        renderFrame()

    </script>
</body>
</html>